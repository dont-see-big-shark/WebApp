!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire951b,n=t.register;n("3B3VN",function(n,r){Object.defineProperty(n.exports,"__esModule",{value:!0,configurable:!0}),e(n.exports,"default",function(){return G});var a,i,o,c,s,l,u,d,f,h,p,m,v,b,g,y,j,x=t("dxPlC"),w=t("74VEB"),O=t("6IIPT"),k=t("dCZP4"),_=t("9Um8W"),C=t("8Otwi"),P=t("kPaC9"),A=t("lRPiZ"),F=t("9CDCO"),S=t("hiQdF"),T=t("jOtlI"),I=t("eCT7v"),E=t("783lP"),L=t("fmkUX"),R=t("912gW"),B=t("kYLP9"),M=t("lHM0e"),H=function(e,t,n,r,a,i){function o(e){if(void 0!==e&&"function"!=typeof e)throw TypeError("Function expected");return e}for(var c,s=r.kind,l="getter"===s?"get":"setter"===s?"set":"value",u=!t&&e?r.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),f=!1,h=n.length-1;h>=0;h--){var p={};for(var m in r)p[m]="access"===m?{}:r[m];for(var m in r.access)p.access[m]=r.access[m];p.addInitializer=function(e){if(f)throw TypeError("Cannot add initializers after decoration has completed");i.push(o(e||null))};var v=(0,n[h])("accessor"===s?{get:d.get,set:d.set}:d[l],p);if("accessor"===s){if(void 0===v)continue;if(null===v||"object"!=typeof v)throw TypeError("Object expected");(c=o(v.get))&&(d.get=c),(c=o(v.set))&&(d.set=c),(c=o(v.init))&&a.unshift(c)}else(c=o(v))&&("field"===s?a.unshift(c):d[l]=c)}u&&Object.defineProperty(u,r.name,d),f=!0},D=function(e,t,n){for(var r=arguments.length>2,a=0;a<t.length;a++)n=r?t[a].call(e,n):t[a].call(e);return r?n:void 0},N=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,c)}s((r=r.apply(e,t||[])).next())})},V=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},q=function(e,t,n,r,a){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!a)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},W=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)0>t.indexOf(r[a])&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},z={city:"",direction:"in",personal:!1},G=(u=[(0,T.component)({tagName:"logistics-edit"}),T.observer],d=[],h=[],p=[],m=[],v=[],c=/*#__PURE__*/function(e){(0,_._)(n,e);var t=(0,A._)(n);function n(){var e;return(0,w._)(this,n),e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),a.set((0,x._)(e),D((0,x._)(e),h,"")),i.set((0,x._)(e),(D((0,x._)(e),p),D((0,x._)(e),m,{name:"",url:"",serviceArea:[z],remark:"",contacts:[{name:"",phone:""}]}))),Object.defineProperty((0,x._)(e),"changeText",{enumerable:!0,configurable:!0,writable:!0,value:(D((0,x._)(e),v),function(t){var n=t.target,r=n.name,a=n.value;e.state=Object.assign(Object.assign({},e.state),(0,k._)({},r,a))})}),Object.defineProperty((0,x._)(e),"addServiceArea",{enumerable:!0,configurable:!0,writable:!0,value:function(){return e.state=Object.assign(Object.assign({},e.state),{serviceArea:(0,C._)(e.state.serviceArea).concat([{}])})}}),Object.defineProperty((0,x._)(e),"handleSubmit",{enumerable:!0,configurable:!0,writable:!0,value:function(t){return N((0,x._)(e),void 0,void 0,function(){var e,n,r,a;return(0,F.__generator)(this,function(i){switch(i.label){case 0:return t.preventDefault(),n=(e=this.state).serviceArea,r=e.contacts,a=W(e,["serviceArea","contacts"]),[4,(0,R.logistics).updateOne(Object.assign(Object.assign({},a),{serviceArea:n.filter(function(e){var t=e.city;return null==t?void 0:t.trim()}),contacts:r.filter(function(e){var t=e.name,n=e.phone;return(null==t?void 0:t.trim())&&(null==n?void 0:n.trim())})}),this.dataId)];case 1:return i.sent(),self.alert("提交成功，工作人员审核后即可查看"),location.hash=L.RouteRoot.Logistics,[2]}})})}}),e}return(0,O._)(n,[{key:"dataId",get:function(){return V(this,a,"f")},set:function(e){q(this,a,e,"f")}},{key:"state",get:function(){return V(this,i,"f")},set:function(e){q(this,i,e,"f")}},{key:"mountedCallback",value:function(){return N(this,void 0,void 0,function(){var e,t,n,r,a,i;return(0,F.__generator)(this,function(o){switch(o.label){case 0:if(!this.dataId)return[2];return[4,(0,R.logistics).getOne(this.dataId)];case 1:return t=(e=o.sent()).name,n=e.url,r=e.serviceArea,a=e.remark,i=e.contacts,this.state={name:t,url:n,serviceArea:r,remark:a,contacts:i},[2]}})})}},{key:"changeServiceArea",value:function(e,t){t.stopPropagation();var n=t.target,r=n.name,a=n.value;"personal"===r?this.state.serviceArea[e].personal=JSON.parse(a):this.state.serviceArea[e][r]=a}},{key:"deleteServiceArea",value:function(e){var t=this.state.serviceArea;this.state.serviceArea=(0,C._)(t.slice(0,e)).concat((0,C._)(t.slice(e+1)))}},{key:"render",value:function(){var e=this,t=this.state,n=t.name,r=t.url,a=t.serviceArea,i=t.remark,o=t.contacts;return(0,S.jsxs)(B.SessionBox,{children:[(0,S.jsx)("h2",{children:"物流信息发布"}),(0,S.jsxs)("form",{onChange:this.changeText,onSubmit:this.handleSubmit,children:[(0,S.jsx)(E.FormField,{name:"name",required:!0,defaultValue:n,label:"物流公司名称",placeholder:"请填写物流公司名称"}),(0,S.jsx)(E.FormField,{name:"url",required:!0,defaultValue:r,label:"来源链接",placeholder:"请填写物流来源的链接地址"}),(0,S.jsxs)(E.FormGroup,{children:[(0,S.jsx)(E.FormLabel,{children:"寄送区域与其他能力"}),a.map(function(t,n){var r=t.city,i=t.direction,o=t.personal;return(0,S.jsxs)(E.InputGroup,{className:"my-1",onChange:function(t){return e.changeServiceArea(n,t)},children:[(0,S.jsx)(E.FormControl,{name:"city",value:r,placeholder:"请输入寄送城市"}),(0,S.jsxs)(E.FormControl,{as:"select",name:"direction",value:i,children:[(0,S.jsx)("option",{selected:!0,children:"选择寄送方向"}),(0,S.jsx)("option",{value:"in",children:"只能寄入"}),(0,S.jsx)("option",{value:"out",children:"只能寄出"}),(0,S.jsx)("option",{value:"both",children:"寄入寄出"})]}),(0,S.jsxs)(E.FormControl,{as:"select",name:"personal",children:[(0,S.jsx)("option",{selected:!0,children:"是否接受个人捐赠"}),(0,S.jsx)("option",{value:"true",selected:o,children:"是"}),(0,S.jsx)("option",{value:"false",selected:!o,children:"否"})]}),(0,S.jsx)(E.Button,{variant:"primary",onClick:e.addServiceArea,children:"+"}),(0,S.jsx)(E.Button,{variant:"danger",disabled:!a[1],onClick:function(){return e.deleteServiceArea(n)},children:"-"})]})})]}),(0,S.jsx)(M.ContactField,{list:o,onChange:function(t){var n=t.detail;return e.state.contacts=n}}),(0,S.jsx)(E.FormField,{as:"textarea",name:"remark",defaultValue:i,label:"备注"}),(0,S.jsxs)(E.FormGroup,{className:"mt-3 d-flex flex-column",children:[(0,S.jsx)(E.Button,{type:"submit",variant:"primary",disabled:R.logistics.uploading>0,children:"提交"}),(0,S.jsx)(E.Button,{type:"reset",variant:"danger",onClick:function(){return location.hash=L.RouteRoot.Logistics},children:"取消"})]})]})]})}}]),n}(f=HTMLElement),a=new WeakMap,i=new WeakMap,b=c,g="LogisticsEdit","symbol"===(0,P._)(g)&&(g=g.description?"[".concat(g.description,"]"):""),Object.defineProperty(b,"name",{configurable:!0,value:g}),j="function"==typeof Symbol&&Symbol.metadata?Object.create(null!==(y=f[Symbol.metadata])&&void 0!==y?y:null):void 0,s=[T.attribute,I.observable],l=[I.observable],H(c,null,s,{kind:"accessor",name:"dataId",static:!1,private:!1,access:{has:function(e){return"dataId"in e},get:function(e){return e.dataId},set:function(e,t){e.dataId=t}},metadata:j},h,p),H(c,null,l,{kind:"accessor",name:"state",static:!1,private:!1,access:{has:function(e){return"state"in e},get:function(e){return e.state},set:function(e,t){e.state=t}},metadata:j},m,v),H(null,o={value:c},u,{kind:"class",name:c.name,metadata:j},null,d),c=o.value,j&&Object.defineProperty(c,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:j}),D(c,d),c)}),n("fmkUX",function(t,n){e(t.exports,"RouteRoot",function(){return a}),e(t.exports,"default",function(){return i}),(r=a||(a={})).Hospital="hospital",r.Logistics="logistics",r.Hotel="hotel",r.Factory="factory",r.Donation="donation",r.Clinic="clinic",r.Maps="maps",r.Admin="admin",r.Community="community";var r,a,i=[{title:"首页",href:""},{title:"医院",href:a.Hospital,icon:"hospital"},{title:"物流",href:a.Logistics,icon:"truck"},{title:"酒店",href:a.Hotel,icon:"building-check"},{title:"生产",href:a.Factory,icon:"buildings"},{title:"捐赠",href:a.Donation,icon:"heart"},{title:"义诊",href:a.Clinic,icon:"house-heart"},{title:"疫情地图",href:a.Maps,icon:"map"},{title:"红会监工",href:"https://weileizeng.github.io/red-cross/",icon:"plus-square"},{title:"开放社区",href:a.Community}]})}();